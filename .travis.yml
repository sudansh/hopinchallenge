language: android
jdk: oraclejdk11
os: linux
dist: trusty
env:
  global:
  - secure: P2lwchfMfFJvZZMX01RzGoDGaelzLm+JO0En1SJ65c6nqSeNGJlMAQW+xjtfkQsREj1ksuPPLvzKyTjl9uVmot7f2dHM04dpUiOHafRcNVpV4oezJSN638EEPGP1cKiRA1KRzosqXAQlKRqVHtwq4aXGkte0wwWP1so6PS0Ob6782NOgPOP8rNN6hNVmOn9Kwtjfwg8WOPXuFRdB3nf/j/OwiDsp8ipgHJqrl5X/JttFkSOxMfm06C9d0v7Ae6OK3cNyQ3QI2ICnvY7gyCcmV/Dc+dhGkTBFgR4wr9Tq1NdoeC6mDiLcteugq/1blc/PhFFu6N2QuY7wMjeBW+Rk0dY3XtdqgAV6/QPX6LlafqJ2Ja0X7QzXLAbyxDIVb5XfwhSFYD3uR/T9yseHnoBIKboFszxXPy9j8I1qI/Hk4bsWAXQ/5iy+I+ngkZngfN8tMvHen8ovNMRx0qXa8zPK1pEInY0c5i/kvTVHwdIz8ejAzytDjdi+Ep6iTaZXa54GsFpfhH1ePnC2a1rZGzEwAkfG5sd2zZAZhkHDSyjIRjb1nhOHcuXHKtaIFwUypcduFFi+3vdnkmsypmTw+uS6URKtPXa4MiPpF1mxpKZe8n+Y/yWTzgd+qmu4uOqP2+46R0hGkpq5wFlfGEyP6kiEFDYQk1hOasSRCxI6l0VBb3M=
android:
  components:
    - tools
    - platform-tools
    - extra-google-google_play_services
    - extra-google-m2repository
    - extra-android-m2repository
  licenses:
    - 'android-sdk-preview-license-52d11cd2'
    - 'android-sdk-license-.+'
    - 'google-gdk-license-.+'

before_install:
- chmod +x gradlew
- yes | sdkmanager "platforms;android-30"

jobs:
  include:
  - name: Staging
    script: ./gradlew assembleRelease

before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/

deploy:
  provider: firebase
  token:
    secure: "$FIREBASE_TOKEN"

cache:
  directories:
  - $HOME/.gradle/caches/
  - $HOME/.gradle/wrapper/
  - $HOME/.android/build-cache
  - $HOME/android-cmdline-tools
  - $HOME/android-sdk
